import{aH as b,d as k,b as F,a as N,aI as x,c as m,aJ as D,A as I,u as t,g as J,w as d,i as O,h as V,H as A,o as B,k as i,aK as P,aL as T,aM as H,aN as M,W as y,aF as f}from"./index-4772fb21.js";import{u as U}from"./usePageTitle-4307680d.js";class z extends b{parse(a){return JSON.parse(decodeURIComponent(a??""))}format(a){return encodeURIComponent(JSON.stringify(a))}}const W=k({__name:"FlowRunCreate",setup(_){const a=F(),s=N("deploymentId"),n=A(),c=x("parameters",z,void 0),h=m(()=>!e.value||!c.value?{}:D.map("SchemaValuesResponse",{schema:e.value.parameterOpenApiSchema,values:c.value},"SchemaValues")),w=I(a.deployments.getDeployment,[s]),e=m(()=>w.response),R=async r=>{var u,o;try{const l=await a.deployments.createDeploymentFlowRun(s.value,r),p=((o=(u=r.state)==null?void 0:u.stateDetails)==null?void 0:o.scheduledTime)??void 0,S=!p,g=H(M,{flowRun:l,flowRunRoute:y.flowRun,router:n,immediate:S,startTime:p});f(g,"success"),n.push(y.deployment(s.value))}catch(l){f("Something went wrong trying to create a flow run","error"),console.error(l)}},v=()=>{n.back()},C=m(()=>e.value?`Create Flow Run for Deployment: ${e.value.name}`:"Create Flow Run for Deployment");return U(C),(r,u)=>{const o=V("p-layout-default");return t(e)?(B(),J(o,{key:0},{header:d(()=>[i(t(P),{deployment:t(e)},null,8,["deployment"])]),default:d(()=>[i(t(T),{deployment:t(e),parameters:t(h),onSubmit:R,onCancel:v},null,8,["deployment","parameters"])]),_:1})):O("",!0)}}});export{W as default};
